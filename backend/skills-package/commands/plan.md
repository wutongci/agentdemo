---
description: 规划任务、项目或功能开发
argument-hint: "要规划的任务或项目描述"
allowed-tools: ["fs_read", "fs_write", "bash_run"]
models:
  preferred:
    - claude-sonnet-4-5
    - gpt-4-turbo
  minimum-capabilities:
    - tool-calling
---

# 规划工作流

本命令帮助你制定结构化的实施计划，将复杂任务分解为可执行的步骤。

## 执行流程

### 1. 理解需求

#### 收集信息
- 使用 `fs_read` 了解现有代码结构
- 理解项目的技术栈和架构
- 识别相关的依赖和约束

#### 明确目标
- 功能需求是什么
- 性能要求是什么
- 质量标准是什么
- 时间和资源限制

### 2. 分析和分解

#### 技术分析
- 需要哪些技术或库
- 是否需要架构调整
- 是否有技术难点
- 是否有风险点

#### 任务分解
遵循以下原则分解任务：
- **可测试**：每个任务有明确的完成标准
- **适度粒度**：不太大也不太小（1-4小时完成）
- **低依赖**：尽量减少任务间的依赖
- **可验证**：可以独立验证完成度

### 3. 制定实施计划

使用分阶段的方式组织计划：

```markdown
# [项目/功能名称] 实施计划

## 目标概述
[一段话描述要实现什么]

## 技术方案
### 架构设计
[描述整体架构或主要技术选型]

### 关键技术点
- [技术点1]：[简要说明]
- [技术点2]：[简要说明]

### 技术风险
- [风险1]：[应对策略]
- [风险2]：[应对策略]

---

## 阶段一：[阶段名称]

**目标**：[这个阶段要达成什么]

**成功标准**：
- [ ] [可验证的标准1]
- [ ] [可验证的标准2]

**任务列表**：

### 1.1 [任务名称]
- **描述**：[详细说明要做什么]
- **文件**：[涉及的文件]
- **预计时间**：[时间估算]
- **依赖**：[依赖的前置任务]

### 1.2 [任务名称]
- **描述**：[详细说明要做什么]
- **文件**：[涉及的文件]
- **预计时间**：[时间估算]
- **依赖**：[依赖的前置任务]

**测试计划**：
- [ ] [测试点1]
- [ ] [测试点2]

**状态**：未开始 / 进行中 / 已完成

---

## 阶段二：[阶段名称]

[同样的结构...]

---

## 质量保证

### 代码质量
- [ ] 遵循项目代码规范
- [ ] 通过静态检查
- [ ] 代码审查

### 测试
- [ ] 单元测试覆盖率 > 80%
- [ ] 集成测试通过
- [ ] 手动测试验证

### 文档
- [ ] API 文档更新
- [ ] 代码注释完善
- [ ] 使用说明编写

---

## 时间线

| 阶段 | 预计时间 | 状态 |
|------|----------|------|
| 阶段一 | X 天 | ⏳ |
| 阶段二 | X 天 | ⏳ |
| 阶段三 | X 天 | ⏳ |
| 总计 | X 天 | ⏳ |

---

## 里程碑

- [ ] **M1**: [里程碑1描述] - [日期]
- [ ] **M2**: [里程碑2描述] - [日期]
- [ ] **M3**: [里程碑3描述] - [日期]

---

## 风险管理

| 风险 | 严重程度 | 可能性 | 应对措施 |
|------|----------|--------|----------|
| [风险1] | 高/中/低 | 高/中/低 | [应对策略] |
| [风险2] | 高/中/低 | 高/中/低 | [应对策略] |

---

## 资源需求

- **开发人员**：[人数和技能要求]
- **环境**：[开发/测试环境需求]
- **工具**：[需要的工具或服务]
- **依赖**：[外部依赖]

---

## 后续步骤

1. [立即要做的第一步]
2. [第二步]
3. [第三步]
```

### 4. 保存计划文档

使用 `fs_write` 将计划保存到文件：
- 文件名：`IMPLEMENTATION_PLAN.md`
- 位置：项目根目录或文档目录

### 5. 提供实施指导

- 建议从哪个阶段开始
- 识别关键路径
- 提示需要特别注意的点
- 建议的验证方法

## 使用示例

```
/plan 添加用户认证功能
/plan 优化数据库查询性能
/plan 重构 API 层架构
/plan 实现实时通知系统
```

## 规划原则

- **自顶向下**：从整体到细节
- **迭代式**：分阶段交付价值
- **风险优先**：先解决高风险部分
- **可测试**：每个阶段可以独立测试
- **灵活性**：计划应该可调整

## 最佳实践

- **小步快跑**：频繁交付小的增量
- **持续集成**：每个阶段都保持代码可运行
- **文档同步**：边开发边更新文档
- **代码审查**：每个阶段完成后进行审查
- **回顾调整**：根据实际情况调整计划

## 注意事项

- 保持计划的现实性，不要过于乐观
- 预留缓冲时间应对意外情况
- 考虑团队的实际能力和经验
- 平衡完美与可行性
- 计划要足够详细但不过度设计
